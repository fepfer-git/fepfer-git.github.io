function TimeZone(c){function d(a,b,c,e,h){var g=b.getTimezoneOffset(),l=c.getTimezoneOffset();a.curOffset=-g;b.toTimeString().match(/\((.*)\)/)?a.name=RegExp.$1:b.toTimeString().match(/^\d\d:\d\d:\d\d GMT[+-]\d{4}$/)||(a.unknownFormat=b.toTimeString());if(g!=l){var m=f(b,c,g);var d=f(c,e,l)}else l=e.getTimezoneOffset(),g!=l&&(m=f(c,e,g),d=f(e,h,l));(m||d)&&$.extend(a,{date1:m.getTime(),date1Offset:-l,date2:d.getTime(),date2Offset:-(new Date(d.getTime()+18E6)).getTimezoneOffset()})}function f(a,b,
c){a=new Date(a);b=new Date(b);for(var g,e=0;3E5<=b-a&&0!=++e;)g=new Date(Math.round((b.getTime()+a.getTime())/2)),g.getTimezoneOffset()==c?a=g:b=g;a.setMinutes(5*Math.floor(a.getMinutes()/5)+4,59,0);return a}function k(a){var b=new Date(a);a=b.getMinutes();var c=b.getHours(),e=b.getDay(),h=b.getDate(),d=b.getMonth();a++;60==a&&(a=0,c++,24==c&&(c=0,e=(e+1)%7,b.setDate(h+1,12),h=b.getDate(),d=b.getMonth()));b.setMonth(d+1,0,12);b=b.getDate();return""+(d+1)+","+(7>b-h?"l":Math.floor((h+6)/7))+","+e+
","+c+":"+a}function a(a,c){var e=h.getFullYear(),d=b(a);do{var g=new Date(Date.UTC(e,d.month,0,12)),l=g.getDate(),f=g.getDay(),k=(f+35-l+1)%7;"l"==d.week?g.setUTCDate(l-(f+7-d.dow)%7):g.setUTCDate((d.dow+7-k)%7+1+7*(parseInt(d.week)-1));g.setUTCHours(d.hr,d.min-c-1,59);e++}while(g<h);return g}function b(a){a.match(/^(\d+),([0-3l]),(\d),(\d+):(\d+)/);return{month:parseInt(RegExp.$1),week:RegExp.$2,dow:parseInt(RegExp.$3),hr:parseInt(RegExp.$4),min:parseInt(RegExp.$5)}}var h=new Date;if(c){$.extend(this,
c);if(!this.calc)return!1;this.curOffset||(this.curOffset=this.calc.offset);if(this.date1&&this.calc&&this.calc.up&&h>this.date1){this.calc.increase||(this.calc.increase=60);c=a(this.calc.up,this.calc.offset);var e=a(this.calc.down,this.calc.offset+this.calc.increase),n=c<e?1:2,p=3-n;this["date"+n]=c.getTime();this["date"+n+"Offset"]=this.calc.offset+this.calc.increase;this["date"+p]=e.getTime();this["date"+p+"Offset"]=this.calc.offset;this.curOffset=this.date2Offset}}else c=new Date(h.getFullYear()+
1,0,1,12),e=new Date(h.getFullYear()+1,6,1,12),6>h.getMonth()?d(this,h,new Date(h.getFullYear(),6,1,12),c,e):d(this,h,c,e,new Date(h.getFullYear()+2,0,1,12)),this.date1?(this.calc={offset:Math.min(this.curOffset,this.date1Offset)},this.calc.increase=Math.abs(this.curOffset-this.date1Offset),this.date1Offset>this.curOffset?(this.calc.up=k(this.date1),this.calc.down=k(this.date2)):(this.calc.up=k(this.date2),this.calc.down=k(this.date1))):this.calc={offset:this.curOffset};this.get_object=function(){var a=
this.calc,c={offset:a.offset};a.up&&(c.increase=a.increase,$.each(b(a.up),function(a,b){c["up_"+a]=b}),$.each(b(a.down),function(a,b){c["down_"+a]=b}));return c};this.get_rule_texts=function(){function a(a){a=b(a);a.week={1:"1st",2:"2nd",3:"3rd",4:"4th",l:"Last"}[a.week];return a}return{up:a(this.calc.up),down:a(this.calc.down)}};this.get_next_change=function(){if(!this.date1)return!1;var a=b(this.curOffset==this.calc.offset?this.calc.up:this.calc.down),c=new Date(this.date1),e=(a.dow-c.getDay()+
10)%7-3;c.setDate(c.getDate()+e);return{year:c.getFullYear(),month:c.getMonth(),day:c.getDate(),hour:a.hr,minute:a.min}}}function find_by_rule(c){for(var d=$.map(timezones,function(a,b){return parseInt(b)}),f=0;f<d.length;f++)if(c.offset==d[f])for(var k=timezones[d[f]],a=0;a<k.length;a++){var b=k[a];if(c.up&&b[TZ.RULE]&&b[TZ.RULE]==c.up+"|"+c.down||!c.up&&!b[TZ.RULE])return b}return!1}
function offset_mins_to_UTC(c){if(!c)return"";var d=Math.abs(c);return(0<c?"+":"-")+print2digits(Math.floor(d/60))+":"+print2digits(d%60)}function print2digits(c){return("0"+c).slice(-2)}Date.prototype.add_days=function(c){var d=this.getHours(),f=this.getDate();this.setDate(f+c);this.getHours()!=d&&(this.setHours(d+(d-this.getHours()+24)%24),this.setDate(f+c))};
Date.prototype.reset_hours=function(){this.getHours();var c=this.getDate();this.setHours(0,0,0,0);0!=this.getHours()&&(this.setHours(24-this.getHours()),this.setDate(c))};Date.prototype.getMonthWeek=function(){return Math.floor((this.getDate()-1)/7)+1};Date.prototype.getLastDate=function(){return(new Date(this.getFullYear(),this.getMonth()+1,0)).getDate()};
(function(){var c="d/m/y",d="12h",f="Su Mo Tu We Th Fr Sa".split(" "),k="January February March April May June July August September October November December".split(" ");get_first_weekday=function(){return 0};get_day_name=function(a){return f[a%7]};get_month_name=function(a){return k[a]};get_date_format=function(){return c};set_date_format=function(a){-1==$.inArray(a,["d/m/y","d.m.y","m/d/y","m.d.y","y/m/d"])&&console.error("Invalid date format "+a);c=a};DateObj_to_str=function(a,b){return a?dy_mn_yr_to_str(a.day,
a.month,a.year,b):""};Date_to_str=function(a,b){return a?dy_mn_yr_to_str(a.getDate(),a.getMonth()+1,a.getFullYear(),b):""};dy_mn_yr_to_str=function(a,b,d,e){e||(e={});switch(c){case "d/m/y":return a+(e.noMonth?"":"/"+b)+(e.noYear?"":"/"+d);case "d.m.y":return a+(e.noMonth?"":"."+b)+(e.noYear?"":"."+d);case "m/d/y":return(e.noMonth?"":b+"/")+a+(e.noYear?"":"/"+d);case "m.d.y":return(e.noMonth?"":b+".")+a+(e.noYear?"":"."+d);case "y/m/d":return(e.noYear?"":d+"/")+(e.noMonth?"":b+"/")+a}};str_to_dateObj=
function(a){a=a.trim();switch(c){case "d/m/y":case "d.m.y":if(!a.match(/^\s*(\d\d?)[\/\.](\d\d?)[\/\.](\d{2,4})\s*$/))return!1;a=parseInt(RegExp.$3,10);var b=parseInt(RegExp.$2,10)-1;var d=parseInt(RegExp.$1,10);break;case "m/d/y":case "m.d.y":if(!a.match(/^\s*(\d\d?)[\/\.](\d\d?)[\/\.](\d{2,4})\s*$/))return!1;a=parseInt(RegExp.$3,10);b=parseInt(RegExp.$1,10)-1;d=parseInt(RegExp.$2,10);break;case "y/m/d":if(!a.match(/^\s*(\d{2,4})[\/\.](\d\d?)[\/\.](\d\d?)\s*$/))return!1;a=parseInt(RegExp.$1,10);
b=parseInt(RegExp.$2,10)-1;d=parseInt(RegExp.$3,10);break;default:return!1}500>a&&(a+=2E3);if(2E3>a||2099<a)return!1;var e=new Date(a,b,d),f=e.getTime();if(isNaN(f)||e.getDate()!=d||e.getMonth()!=b||e.getFullYear()!=a)return!1;wd=e.getDay();return{year:a,month:b+1,day:d,wday:wd}};compare_dateObj=function(a,b){return a.year!=b.year?a.year>b.year?1:-1:a.month!=b.month?a.month>b.month?1:-1:a.day!=b.day?a.day>b.day?1:-1:0};Date_to_dateObj=function(a){if(!a)return!1;var b=a.getTime();return isNaN(b)?!1:
{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),wday:a.getDay()}};DateObj_to_Date=function(a,b){return new Date(a.year,a.month-1,a.day,b?12:0)};get_time_format=function(){return d};set_time_format=function(a){-1==$.inArray(a,["24h","12h"])&&console.error("Invalid time format "+a);d=a};get_hour_format_help=function(){switch(d){case "24h":return"An integer between 0-23";case "12h":return"An integer between 1-12"}};str_to_hour=function(a){a=a.trim().toUpperCase();var b=parseInt(a);switch(d){case "24h":return a.match(/^\d\d?$/)?
24>b?b:!1:!1;case "12h":return a.match(/^\d\d?([AP])m$/)?"A"==RegExp.$1?b:b+12:!1}return!1};hr_mn_to_str=function(a,b){switch(d){case "24h":return print2digits(a)+":"+print2digits(b);case "12h":return print2digits((a+11)%12+1)+":"+print2digits(b)+" "+(12<=a?"PM":"AM")}}})();